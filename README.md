# Калькулятор арифметических выражений (веб-сервис)

Веб-сервис для вычисления арифметических выражений. Принимает выражение через HTTP POST запрос и возвращает результат вычисления.

## Возможности

- Поддержка базовых арифметических операций:
  - Сложение (+)
  - Вычитание (-)
  - Умножение (*)
  - Деление (/)
- Поддержка скобок для изменения приоритета операций
- Поддержка отрицательных чисел
- Поддержка десятичных чисел (через точку)
- Игнорирование пробелов в выражении

## Установка и запуск

1. Убедитесь, что у вас установлен Go версии 1.19 или выше
2. Клонируйте репозиторий:
```bash
git clone https://github.com/your-username/calculator-service.git
cd calculator-service
```

3. Запустите сервис:
```bash
go run ./cmd/calc_service/...
```

Сервис будет доступен по адресу `http://localhost:8080`

## API

### Вычисление выражения

**URL**: `/api/v1/calculate`

**Метод**: `POST`

**Заголовки**:
```
Content-Type: application/json
```

**Тело запроса**:
```json
{
    "expression": "2+2*2"
}
```

### Ответы

#### Успешное вычисление (200 OK)
```json
{
    "result": 6
}
```

#### Некорректное выражение (422 Unprocessable Entity)
```json
{
    "error": "Expression is not valid"
}
```

#### Внутренняя ошибка сервера (500 Internal Server Error)
```json
{
    "error": "Internal server error"
}
```

## Примеры использования

### 1. Успешное вычисление
```bash
curl --location 'localhost:8080/api/v1/calculate' \
--header 'Content-Type: application/json' \
--data '{
    "expression": "2+2*2"
}'
```
Ответ:
```json
{
    "result": 6
}
```

### 2. Ошибка валидации (недопустимые символы)
```bash
curl --location 'localhost:8080/api/v1/calculate' \
--header 'Content-Type: application/json' \
--data '{
    "expression": "2+2*a"
}'
```
Ответ:
```json
{
    "error": "Expression is not valid"
}
```

### 3. Внутренняя ошибка (деление на ноль)
```bash
curl --location 'localhost:8080/api/v1/calculate' \
--header 'Content-Type: application/json' \
--data '{
    "expression": "1/0"
}'
```
Ответ:
```json
{
    "error": "Internal server error"
}
```

### 4. Сложные выражения
```bash
curl --location 'localhost:8080/api/v1/calculate' \
--header 'Content-Type: application/json' \
--data '{
    "expression": "(2.5 + 3) * (-2)"
}'
```
Ответ:
```json
{
    "result": -11
}
```

## Обработка ошибок

1. **422 Unprocessable Entity** возвращается, когда:
   - Выражение содержит недопустимые символы
   - Неправильный формат чисел
   - Несбалансированные скобки
   - Пустое выражение
   - Некорректное математическое выражение

2. **500 Internal Server Error** возвращается, когда:
   - Происходит деление на ноль
   - Возникают другие внутренние ошибки сервера

## Требования к системе

- Go 1.19 или выше
- Доступный порт 8080

## Структура проекта

```
.
├── README.md
├── cmd/
│   └── calc_service/
│       └── main.go
└── go.mod
```

## Разработка и тестирование

Для локальной разработки и тестирования:

1. Запустите сервис:
```bash
go run ./cmd/calc_service/...
```

2. Проверьте работу сервиса с помощью curl или любого HTTP-клиента

## Логирование

Сервис ведет подробное логирование всех запросов, включая:
- Время получения запроса
- Метод и путь запроса
- Полученное выражение
- Результат вычисления или ошибку
- Время выполнения запроса